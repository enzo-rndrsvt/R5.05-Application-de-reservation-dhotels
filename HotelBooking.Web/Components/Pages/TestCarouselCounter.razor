@page "/test-carousel-counter"
@using HotelBooking.Web.Models
@inject IJSRuntime JSRuntime

<PageTitle>Test Carrousel avec Compteur</PageTitle>

<div class="container mt-4">
    <div class="card">
        <div class="card-header bg-primary text-white">
            <h4>?? Test du Carrousel avec Indicateur de Position</h4>
        </div>
        <div class="card-body">
            <p>Cette page de test simule l'affichage du carrousel avec l'indicateur de position (1/X).</p>
            
            <!-- Simulation du carrousel -->
            <div class="position-relative" style="height: 400px; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px;">
                
                <!-- Indicateur de position comme dans RoomDetails -->
                <div style="position: absolute; top: 15px; left: 15px; background: linear-gradient(135deg, rgba(245, 158, 11, 0.95) 0%, rgba(217, 119, 6, 0.95) 100%); color: #000; padding: 8px 14px; border-radius: 25px; font-size: 0.9rem; font-weight: 700; z-index: 10; backdrop-filter: blur(10px); border: 2px solid rgba(245, 158, 11, 0.4); box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3), 0 2px 8px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.2); text-shadow: none; letter-spacing: 0.5px; min-width: 55px; text-align: center; line-height: 1.2; user-select: none; pointer-events: none;">
                    @(currentSlide + 1)/@testImages.Count
                </div>

                <!-- Image simulée -->
                <div class="position-absolute top-50 start-50 translate-middle text-center">
                    <div class="display-1 text-muted mb-3">???</div>
                    <h5 class="text-muted">Image @(currentSlide + 1) - @testImages[currentSlide]</h5>
                    <p class="text-muted">L'indicateur en haut à gauche affiche la position actuelle</p>
                </div>

                <!-- Contrôles de navigation -->
                <button class="btn btn-dark position-absolute top-50 start-0 translate-middle-y ms-3" 
                        @onclick="PreviousImage"
                        style="z-index: 5;">
                    ‹
                </button>
                <button class="btn btn-dark position-absolute top-50 end-0 translate-middle-y me-3" 
                        @onclick="NextImage"
                        style="z-index: 5;">
                    ›
                </button>
            </div>

            <!-- Miniatures -->
            <div class="d-flex gap-2 mt-3 justify-content-center">
                @for (int i = 0; i < testImages.Count; i++)
                {
                    var index = i;
                    <button class="btn @(i == currentSlide ? "btn-warning" : "btn-outline-secondary") btn-sm"
                            @onclick="@(() => GoToImage(index))">
                        @(i + 1)
                    </button>
                }
            </div>

            <div class="mt-4 alert alert-info">
                <h6><i class="oi oi-info"></i> Instructions de Test :</h6>
                <ul class="mb-0">
                    <li>Utilisez les flèches ? ? pour naviguer</li>
                    <li>Cliquez sur les numéros pour aller à une image spécifique</li>
                    <li>Observez que l'indicateur (1/@testImages.Count) se met à jour en temps réel</li>
                    <li>Le style est identique à celui de la page des détails de chambre</li>
                </ul>
            </div>

            <!-- Informations techniques -->
            <div class="mt-3">
                <strong>État actuel :</strong>
                <ul>
                    <li><strong>Image actuelle :</strong> @(currentSlide + 1)</li>
                    <li><strong>Total d'images :</strong> @testImages.Count</li>
                    <li><strong>Indicateur affiché :</strong> @(currentSlide + 1)/@testImages.Count</li>
                </ul>
            </div>

            <!-- Lien vers la vraie page -->
            <div class="mt-4 pt-3 border-top">
                <a href="/rooms" class="btn btn-success">
                    <i class="oi oi-grid-three-up"></i> Voir les vraies chambres avec carrousel
                </a>
            </div>
        </div>
    </div>
</div>

@code {
    private List<string> testImages = new()
    {
        "Chambre pirate luxueuse",
        "Vue sur l'océan",
        "Salle de bain thématique", 
        "Balcon avec hamac",
        "Intérieur décoré"
    };
    
    private int currentSlide = 0;

    private void NextImage()
    {
        currentSlide = (currentSlide + 1) >= testImages.Count ? 0 : currentSlide + 1;
        StateHasChanged();
    }

    private void PreviousImage()
    {
        currentSlide = (currentSlide - 1) < 0 ? testImages.Count - 1 : currentSlide - 1;
        StateHasChanged();
    }

    private void GoToImage(int index)
    {
        if (index >= 0 && index < testImages.Count)
        {
            currentSlide = index;
            StateHasChanged();
        }
    }
}